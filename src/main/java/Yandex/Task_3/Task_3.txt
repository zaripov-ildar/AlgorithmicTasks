Планировщик 100 баллов

Имеется mm исполнителей, пронумерованных числами от 11 до mm, и kk очередей задач, пронумерованных числами от 11 до kk. Изначально очереди пусты. Системе предстоит выполнить nn задач: ii-я задача встанет в очередь с номером qiqi​ на sisi​-й секунде и потребует titi​ секунд на выполнение.

Каждую секунду происходит следующее:

    В конец некоторых очередей могут добавиться новые задачи (но не более одной задачи в каждую очередь)
    Пока это возможно, выбирается незанятый исполнитель с наименьшим номером
    и непустая очередь, из которой дольше всего не забирались задачи. Если таких очередей несколько, то выбирается очередь с наименьшим номером. Исполнитель забирает задачу из очереди и становится занятым на время ее выполнения.

Для каждой задачи определите, когда и какой исполнитель начнет ее выполнять.
Формат ввода

В первой строке находятся числа nn, mm, kk (1≤n,m,k≤2⋅1051≤n,m,k≤2⋅105).

В каждой ii-й из последующих nn строк находятся 33 числа: sisi​, qiqi​ и titi​ (1≤si,ti≤10^9;1≤qi≤k1≤si,ti≤10^9;1≤qi​≤k) — время в секундах постановки ii-й задачи в очередь, номер очереди и время в секундах, необходимое на выполнение задачи, соответственно.

Гарантируется, что si≤sjsi​≤sj​ при i<ji<j.
Формат вывода

Для каждой задачи в порядке их следования во входных данных выведите по 2 числа:
номер исполнителя и время в секундах, когда он заберет эту задачу из ее очереди. То есть суммарно нужно вывести 2n2n чисел.
Пример 1
Ввод

5 1 2
1 1 5
1 2 3
2 2 1
3 1 2
4 1 3

Вывод

1 1
1 6
1 11
1 9
1 12

Пример 2
Ввод

5 2 2
1 1 5
1 2 3
2 2 1
3 1 2
4 1 3

Вывод

1 1
2 1
1 6
2 4
2 6

Пример 3
Ввод

5 2 2
1 1 1
1 2 5
2 2 1
5 1 3
6 1 3

Вывод

1 1
2 1
1 2
1 5
2 6

Примечание

Система оценки: в задаче используется потестовая оценка. Баллы начисляются за долю пройденных тестов выше 10%, т.е. за 60% пройденных тестов будет начислено 55% баллов, а за 55% — 50%.
Ограничение памяти
256.0 Мб
Ограничение времени
15 с
Ввод
стандартный ввод или input.txt
Вывод
стандартный вывод или output.txt